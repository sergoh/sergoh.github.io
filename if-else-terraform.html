
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="google-site-verification" content="w_Gq0a37aj_D2iAwIQodXXlrE7Aj8mF8-W5BpUsK6B4" />
  <meta name="robots" content="index, follow" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://www.devlo.io/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://www.devlo.io/theme/pygments/arduino.min.css">



  <link rel="stylesheet" type="text/css" href="https://www.devlo.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://www.devlo.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://www.devlo.io/theme/font-awesome/css/solid.css">

  <link rel="stylesheet" type="text/css" href="https://www.devlo.io/extra/static/custom.css">

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="theme/favicon.ico" type="image/x-icon">


  <link href="https://www.devlo.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="DevLo Software Blog Atom">


<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-116740360-1', 'auto');
  ga('send', 'pageview');
</script>






 

<meta name="author" content="Miguel Lopez" />
<meta name="description" content="Using if-else statements in Terraform" />
<meta name="keywords" content="aws, cloud, terraform, hcl, hashicorp, if-statements, conditional-logic, infrastructure-as-code, automation">


  <meta property="og:site_name" content="DevLo Software Blog"/>
  <meta property="og:title" content="If, If-else Statements in Terraform"/>
  <meta property="og:description" content="Using if-else statements in Terraform"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://www.devlo.io/if-else-terraform.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2018-04-10 00:00:00-07:00"/>
  <meta property="article:modified_time" content="2025-04-28 00:00:00-07:00"/>
  <meta property="article:author" content="https://www.devlo.io/author/miguel-lopez.html">
  <meta property="article:section" content="automation"/>
  <meta property="article:tag" content="aws"/>
  <meta property="article:tag" content="cloud"/>
  <meta property="article:tag" content="terraform"/>
  <meta property="article:tag" content="hcl"/>
  <meta property="article:tag" content="hashicorp"/>
  <meta property="article:tag" content="if-statements"/>
  <meta property="article:tag" content="conditional-logic"/>
  <meta property="article:tag" content="infrastructure-as-code"/>
  <meta property="article:tag" content="automation"/>
  <meta property="og:image" content="/images/Devlo-Logo.png">

  <title>DevLo Software Blog &ndash; If, If-else Statements in Terraform</title>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({
      google_ad_client: "ca-pub-2119138261035978",
      enable_page_level_ads: true
    });
  </script>

<script>
  (function(w,d,s,l,i){
    w[l]=w[l]||[];
    w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
    j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
    f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-T32GC6Q');
</script>
</head>
<body class="light-theme">
<noscript>
  <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T32GC6Q" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<aside>
  <div>
    <a href="https://www.devlo.io/">
      <img src="/images/Devlo-Logo.png" alt="" title="">
    </a>

    <h1>
      <a href="https://www.devlo.io/"></a>
    </h1>

    <p>Lopez Brothers Blog</p>

    <div class="authors-profiles">
      <div>
        <figure>
          <img src="https://www.devlo.io/theme/img/miguel.png" alt="Miguel" title="Miguel">
          <figcaption>Miguel</figcaption>
        </figure>
        <ul class="social">
          <li>
            <a class="sc-linkedin"
               href="https://www.linkedin.com/in/lopezm1/"
               target="_blank">
              <i class="fa-brands fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a class="sc-github"
               href="https://github.com/lopezm1"
               target="_blank">
              <i class="fa-brands fa-github"></i>
            </a>
          </li>
        </ul>
      </div>
      <div>
        <figure>
          <img src="https://www.devlo.io/theme/img/sergio.png" alt="Sergio" title="Sergio">
          <figcaption>Sergio</figcaption>
        </figure>
        <ul class="social">
          <li>
            <a class="sc-linkedin"
               href="https://www.linkedin.com/in/sergiolopezjr/"
               target="_blank">
              <i class="fa-brands fa-linkedin"></i>
            </a>
          </li>
          <li>
            <a class="sc-github"
               href="https://github.com/sergoh"
               target="_blank">
              <i class="fa-brands fa-github"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>



    <nav>
      <ul class="list">


            <li>
              <a target="_self"
                 href="https://www.devlo.io/pages/about.html">
                About
              </a>
            </li>

      </ul>
    </nav>

  </div>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-aside"
         data-ad-client="ca-pub-2119138261035978"
         data-ad-slot="7180191250"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</aside>
  <main>
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <ins class="adsbygoogle ads-responsive"
           data-ad-client="ca-pub-2119138261035978"
           data-ad-slot="7180191250"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

<nav>
  <a href="https://www.devlo.io/">Home</a>

  <a href="/archives.html">Archives</a>
  <a href="/categories.html">Categories</a>
  <a href="/tags.html">Tags</a>

  <a href="https://www.devlo.io/feeds/all.atom.xml">Atom</a>

</nav>

<article class="single">
  <header>
      
    <h1 id="if-else-terraform">If, If-else Statements in Terraform</h1>
    <p>
      Posted by <a href="https://www.devlo.io/author/miguel-lopez.html">Miguel Lopez</a> on Tue 10 April 2018 in <a href="https://www.devlo.io/category/automation.html">automation</a>

    </p>
  </header>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="ca-pub-2119138261035978"
         data-ad-slot="5952522457"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

  <div>
    <p><em>Terraform v1.6.0</em></p>
<h2><strong>Introduction</strong></h2>
<p>In Terraform's HCL, conditional logic has evolved significantly, making it easier to implement <code>if</code> and <code>if-else</code> statements. The ternary operator remains a key feature, but newer syntax and features introduced in Terraform v1.6.0 enhance readability and functionality.</p>
<p>The basic syntax for a ternary operation is:</p>
<div class="highlight"><pre><span></span><code><span class="err">condition</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="err">true_value</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">false_value</span>
</code></pre></div>

<p>This allows you to evaluate a condition and return one of two values based on whether the condition is true or false.</p>
<h2><strong>If Statement</strong></h2>
<p>Let's start with a simple example using the <code>count</code> parameter to conditionally create a resource. In this example, we use a boolean variable <code>create_eip</code> to determine whether to create an Elastic IP (EIP).</p>
<div class="highlight"><pre><span></span><code><span class="kr">module</span><span class="w"> </span><span class="nv">&quot;frontend&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">source</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./modules/frontend-app&quot;</span>
<span class="w">  </span><span class="na">box_name</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;web-01&quot;</span>
<span class="w">  </span><span class="na">ami</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ami-25615740&quot;</span>
<span class="w">  </span><span class="na">instance_type</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;t2.micro&quot;</span>
<span class="w">  </span><span class="na">create_eip</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<span class="p">}</span>
</code></pre></div>

<p>In the module, the <code>count</code> parameter uses the ternary operator to conditionally create the resource:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># frontend-app module</span>
<span class="kr">variable</span><span class="w"> </span><span class="nv">&quot;create_eip&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Create an EIP if set to true&quot;</span>
<span class="w">  </span><span class="na">type</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="kt">bool</span>
<span class="w">  </span><span class="na">default</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="no">false</span>
<span class="p">}</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_eip&quot;</span><span class="w"> </span><span class="nv">&quot;web_eip&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">count</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nv">var.create_eip</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span><span class="na">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_instance.example.id</span>
<span class="p">}</span>
</code></pre></div>

<p>If <code>create_eip</code> is set to <code>true</code>, the <code>count</code> evaluates to <code>1</code>, creating one EIP resource. If <code>false</code>, the <code>count</code> evaluates to <code>0</code>, and no resource is created.</p>
<h2><strong>If-Else Statement</strong></h2>
<p>To implement an <code>if-else</code> pattern, we can use multiple resources with conditional <code>count</code> values. Here's an updated example:</p>
<div class="highlight"><pre><span></span><code><span class="kr">module</span><span class="w"> </span><span class="nv">&quot;frontend&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">source</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./modules/frontend-app&quot;</span>
<span class="w">  </span><span class="na">box_name</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;web-01&quot;</span>
<span class="w">  </span><span class="na">ami</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;ami-25615740&quot;</span>
<span class="w">  </span><span class="na">instance_type</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;t2.micro&quot;</span>
<span class="w">  </span><span class="na">create_primary_eip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span>
<span class="p">}</span>
</code></pre></div>

<p>In the module, we define two resources, each with a conditional <code>count</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># frontend-app module</span>
<span class="kr">variable</span><span class="w"> </span><span class="nv">&quot;create_primary_eip&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Create the primary EIP if true, otherwise create the secondary EIP&quot;</span>
<span class="w">  </span><span class="na">type</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="kt">bool</span>
<span class="w">  </span><span class="na">default</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="no">false</span>
<span class="p">}</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_eip&quot;</span><span class="w"> </span><span class="nv">&quot;primary_eip&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">count</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nv">var.create_primary_eip</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">0</span>
<span class="w">  </span><span class="na">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_instance.example.id</span>
<span class="p">}</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_eip&quot;</span><span class="w"> </span><span class="nv">&quot;secondary_eip&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">count</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nv">var.create_primary_eip</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="m">1</span>
<span class="w">  </span><span class="na">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_instance.example.id</span>
<span class="p">}</span>
</code></pre></div>

<p>If <code>create_primary_eip</code> is <code>true</code>, the <code>primary_eip</code> resource is created, and the <code>secondary_eip</code> resource is skipped. If <code>false</code>, the <code>secondary_eip</code> resource is created instead.</p>
<h2><strong>Using Dynamic Blocks</strong></h2>
<p>Terraform 1.6.0 introduces enhanced support for dynamic blocks, which can simplify conditional logic in complex configurations. Here's an example:</p>
<div class="highlight"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">&quot;aws_security_group&quot;</span><span class="w"> </span><span class="nv">&quot;example&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="na">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;example-sg&quot;</span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Example security group&quot;</span>

<span class="w">  </span><span class="err">dynamic</span><span class="w"> </span><span class="s2">&quot;ingress&quot;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="na">for_each</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.enable_ingress</span><span class="w"> </span><span class="p">?</span><span class="w"> </span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="nb">content</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="na">from_port</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">80</span>
<span class="w">      </span><span class="na">to_port</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="m">80</span>
<span class="w">      </span><span class="na">protocol</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tcp&quot;</span>
<span class="w">      </span><span class="na">cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;0.0.0.0/0&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>In this example, the <code>ingress</code> block is only created if <code>var.enable_ingress</code> is <code>true</code>.</p>
<h2><strong>Conclusion</strong></h2>
<p>Terraform's conditional logic, including the ternary operator and dynamic blocks, provides powerful tools for managing infrastructure as code. By leveraging these features, you can create flexible and maintainable configurations that adapt to your needs.</p>
<p>With the updates in Terraform v1.6.0, writing conditional logic is more intuitive and expressive than ever. Start using these patterns in your projects today!</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://www.devlo.io/tag/aws.html">aws</a>
      <a href="https://www.devlo.io/tag/cloud.html">cloud</a>
      <a href="https://www.devlo.io/tag/terraform.html">terraform</a>
      <a href="https://www.devlo.io/tag/hcl.html">hcl</a>
      <a href="https://www.devlo.io/tag/hashicorp.html">hashicorp</a>
      <a href="https://www.devlo.io/tag/if-statements.html">if-statements</a>
      <a href="https://www.devlo.io/tag/conditional-logic.html">conditional-logic</a>
      <a href="https://www.devlo.io/tag/infrastructure-as-code.html">infrastructure-as-code</a>
      <a href="https://www.devlo.io/tag/automation.html">automation</a>
    </p>
  </div>





    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <ins class="adsbygoogle ads-responsive"
         data-ad-client="ca-pub-2119138261035978"
         data-ad-slot="5952522457"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

</article>

<footer>
<p>&copy;  </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " DevLo Software Blog ",
  "url" : "https://www.devlo.io",
  "image": "/images/Devlo-Logo.png",
  "description": "DevLo - Software Blog."
}
</script>
</body>
</html>